FROM amazon/aws-lambda-nodejs:18.2023.03.08.12

ENV NPM_SCOPE='@mrwconsulting'
ENV NPM_TOKEN='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'
RUN npm config set ${NPM_SCOPE}:registry https://npm.pkg.github.com
RUN npm config set //npm.pkg.github.com/:_authToken ${NPM_TOKEN}
RUN npm install ${NPM_SCOPE}/shinto -global

ENV FUNCTION_DIR="/var/task"
RUN mkdir -p ${FUNCTION_DIR}
COPY index.ts ${FUNCTION_DIR}

CMD [ "index.unregister" ]